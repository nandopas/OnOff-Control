MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001                 LIST P=16F747
                      00002                 title "Case 3, Group 7"
                      00003 ;***********************************************************
                      00004 ;
                      00005 ; This program runs on the Mechatronics microcomputer board.
                      00006 ; On this microcomputer board, Port D is connected to 8 LEDs.
                      00007 ; Port C is connected to 2 switches, both of which will be used.
                      00008 ; This program increments a file register Count every time
                      00009 ; the green pushbutton switch (PortC pin 0) is pressed.
                      00010 ; The program decrements the file register Count every time
                      00011 ; the red pushbutton switch (PortC pin 1) is pressed.
                      00012 ; The value of Count is displayed on the LEDs connected
                      00013 ; to Port D.
                      00014 ;
                      00015 ; (Note: when entered correctly, this progran will generate 2
                      00016 ; messages in the Assembler.)
                      00017 ;
                      00018 ; The net result is that LEDs should increment or decrement
                      00019 ; in a binary manner every time a switch is pressed.
                      00020 ;
                      00021 ;
                      00022 ; State register (not used)
                      00023 ; bit 0
                      00024 ; bit 1
                      00025 ; bit 2
                      00026 ; bit 3
                      00027 ; bit 4
                      00028 ; bit 5
                      00029 ; bit 6
                      00030 ; bit 7
                      00031 ;
                      00032 ;***********************************************************
                      00033                 #include <P16F747.INC>
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  MPASM PIC16F747 processor include
                      00005 ; 
                      00006 ;  (c) Copyright 1999-2013 Microchip Technology, All rights reserved
                      00007 ;==========================================================================
                      00008 
                      00670         LIST
2007   3FA2           00034         __CONFIG _CONFIG1, _FOSC_HS & _CP_OFF & _DEBUG_OFF & _VBOR_2_0 & _BOREN_0 & _MCLR_ON & _PWRTE_ON
                             & _WDT_OFF
2008   3FBC           00035         __CONFIG _CONFIG2, _BORSEN_0 & _IESO_OFF & _FCMEN_OFF
                      00036 
                      00037 ; Note: the format for the CONFIG directive starts with a double underscore.
                      00038 ; The above directive sets the oscillator to an external high speed clock,
                      00039 ; sets the watchdog timer off, sets the power up timer on, sets the system
                      00040 ; clear on (which enables the reset pin) and turns code protect off.
                      00041 ; Variable declarations
                      00042 
  00000020            00043 Count   equ     20h                     ; the counter
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE  2
Case 3, Group 7

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000021            00044 State   equ     21h                     ; the program state register
  00000022            00045 Octal   equ             22h                             ; the octal switch register
  00000023            00046 Temp1   equ     23h                     ; temporary register 1
  00000024            00047 Temp2   equ             24h                             ; temporary register 2
  00000025            00048 Timer0  equ             25h
  00000026            00049 Timer1  equ             26h
  00000027            00050 Timer2  equ             27h
                      00051 
0000                  00052                 org     00h                             ; Assembler directive - Reset Vector
                      00053 
0000   2815           00054                 goto    initPort                ; initiate ports
0004                  00055                 org             04h                             ; interrupt vector
0004   2924           00056                 goto    isrService              ; jump to interrupt service routine (dummy)
0015                  00057                 org     15h                             ; Beginning of program storage
                      00058 ;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                      00059 ;
                      00060 ; Port Initialization
0015                  00061 initPort
0015   0189           00062                 clrf    PORTE                   ; Clear Port E output latches
0016   0188           00063                 clrf    PORTD                   ; Clear Port D output latches
0017   0187           00064                 clrf    PORTC                   ; Clear Port C output latches
0018   0186           00065                 clrf    PORTB                   ; Clear Port B output latches
0019   1683           00066                 bsf     STATUS,RP0              ; Set bit in STATUS register for bank 1
001A   30FF           00067                 movlw   B'11111111'             ; move hex value FF into W register
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
001B   0087           00068                 movwf   TRISC                   ; Configure Port C as all inputs
001C   3007           00069                 movlw   B'00000111'             ; Configure pin 0, 1 and 2 of PORTE as inputs
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
001D   0089           00070                 movwf   TRISE                   ; Configure Port E as all inputs
001E   30F2           00071                 movlw   B'11110010'             ; move binary value 11110010 into W regiter
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
001F   0088           00072                 movwf   TRISD                   ; Configure pin 0,2,3 of Port D as outputs and others in
                            puts
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0020   0186           00073                 clrf    TRISB                   ; Configure Port B as all outputs
0021   1283           00074                 bcf     STATUS,RP0              ; Clear bit in STATUS register for bank 0
0022   2027           00075                 call    initAD                  ; call to initialize A/D
0023   20F8           00076                 call    SetupDelay              ; delay for Tad (see data sheet) prior to A/D start
0024   01A0           00077                 clrf    Count                   ; zero the counter
0025   151F           00078                 bsf             ADCON0,GO               ; start A/D conversion
0026   284F           00079                 goto    waitPress               ; wait for button to be pressed
                      00080 
                      00081 ;
                      00082 ;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                      00083 ;
                      00084 ;
                      00085 ; Initializes and sets up the A/D hardware
0027                  00086 initAD
0027   1683           00087                 bsf     STATUS,RP0              ; select register bank 1
0028   300A           00088                 movlw   B'00001010'     ; RA0,RA1,RA3 analog inputs, all other digital
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0029   009F           00089                 movwf   ADCON1                  ; move to special function A/D register
002A   1283           00090                 bcf     STATUS,RP0              ; select register bank 0
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE  3
Case 3, Group 7

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002B   3041           00091                 movlw   B'01000001'     ; select 8 * oscillator, analog input 0, turn on
002C   009F           00092                 movwf   ADCON0                  ; move to special function A/D register
002D   0008           00093                 return
                      00094 ;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                      00095 ;
                      00096 ;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                      00097 
                      00098 
002E                  00099 Mode1234
002E   0809           00100                 movf    PORTE,W                 ; read PORTE
002F   00A2           00101                 movwf   Octal                   ; move to Octal
                      00102                 
0030   17A2           00103                 bsf             Octal,7                 ; set pin 3 to 7 of Octal to 1
0031   1722           00104                 bsf             Octal,6
0032   16A2           00105                 bsf             Octal,5
0033   1622           00106                 bsf             Octal,4
0034   15A2           00107                 bsf             Octal,3
                      00108 
0035   0922           00109                 comf    Octal,W                 ; complement the value of Octal
0036   00A2           00110                 movwf   Octal                   ; move back to Octal
                      00111 
0037   0BA2           00112                 decfsz  Octal,F                 ; decrement Octal
0038   283A           00113                 goto    Mode234                 ; if not 0, check if mode 2, 3 or 4
0039   2840           00114                 goto    Mode1                   ; if 0, go to mode 1
                      00115 
003A                  00116 Mode234
003A   0BA2           00117                 decfsz  Octal,F                 ; decrement Octal
003B   283D           00118                 goto    Mode34                  ; if not 0, check if mode 3 or 4
003C   2843           00119                 goto    Mode2                   ; if 0, go to mode 2
                      00120 
003D                  00121 Mode34
003D   0BA2           00122                 decfsz  Octal,F                 ; decrement Octal
003E   284A           00123                 goto    Mode4                   ; if 0, go to mode 4 or error
003F   2846           00124                 goto    Mode3                   ; if 0, go to mode 3
                      00125 
                      00126 
                      00127 
0040                  00128 Mode1
0040   0186           00129                 clrf    PORTB                   ; clear the mode led
0041   1406           00130                 bsf     PORTB,0                 ; set led bit
0042   2859           00131                 goto    waitPress1              ; start mode 1
                      00132 
                      00133 
0043                  00134 Mode2
0043   0186           00135                 clrf    PORTB                   ; clear the mode led
0044   1486           00136                 bsf     PORTB,1                 ; set led bit
0045   286A           00137                 goto    waitPress2              ; start mode 2
                      00138 
                      00139 
0046                  00140 Mode3
0046   0186           00141         clrf    PORTB                   ; clear the mode led
0047   1406           00142         bsf     PORTB,0                 ; set led bit
0048   1486           00143                 bsf     PORTB,1                 ; set led bit
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE  4
Case 3, Group 7

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0049   2887           00144                 goto    waitPress3              ; start mode 3
                      00145 
                      00146 
004A                  00147 Mode4
004A   0186           00148                 clrf    PORTB                   ; clear the mode led
004B   1506           00149                 bsf     PORTB,2                 ; set led bit
004C   0BA2           00150                 decfsz  Octal,F                 ; decrement Octal
004D   2921           00151                 goto    ProgramError    ; if not 0, indicate error
004E   28AD           00152                 goto    waitPress4              ; if 0, start mode 4
                      00153 
                      00154 ;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                      00155 
004F                  00156 waitPress
004F   1807           00157                 btfsc   PORTC,0                 ; see if green button pressed
0050   2852           00158                 goto    GreenPress              ; green button is pressed - goto routine
0051   284F           00159                 goto    waitPress               ; loop until green button is pressed
                      00160 
0052                  00161 GreenPress
0052   2115           00162                 call    MainOff                 ; turn off main transistor
0053   1C07           00163                 btfss   PORTC,0                 ; see if green button still pressed
0054   284F           00164                 goto    waitPress               ; noise - button not pressed - keep checking
                      00165 
0055                  00166 GreenRelease
0055   1807           00167                 btfsc   PORTC,0                 ; see if green button released
0056   2855           00168                 goto    GreenRelease    ; no - keep waiting
0057   20DB           00169                 call    SwitchDelay     ; let switch debounce
0058   282E           00170                 goto    Mode1234                ; choose the mode
                      00171 
                      00172 ;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                      00173 
0059                  00174 waitPress1
0059   1807           00175                 btfsc   PORTC,0                 ; see if green button pressed
005A   2852           00176                 goto    GreenPress              ; green button is pressed - goto routine
005B   1887           00177                 btfsc   PORTC,1                 ; see if red button pressed
005C   285E           00178                 goto    RedPress1               ; red button is pressed - goto routine
005D   2859           00179                 goto    waitPress1              ; keep checking
                      00180 
005E                  00181 RedPress1
005E   1C87           00182                 btfss   PORTC,1                 ; see if red button still pressed
005F   2859           00183                 goto    waitPress1              ; noise - button not pressed - keep checking
                      00184 
0060                  00185 RedRelease1
0060   1887           00186                 btfsc   PORTC,1                 ; see if red button released
0061   2860           00187                 goto    RedRelease1             ; no - keep waiting
0062   20DB           00188                 call    SwitchDelay     ; let switch debounce
0063   1D08           00189                 btfss   PORTD,2                 ; check if main transistor on
0064   2866           00190                 goto    MainOn1                 ; if not, turn on main transistor
0065   2868           00191                 goto    MainOff1                ; if on, turn off main transistor
                      00192 
0066                  00193 MainOn1
0066   2113           00194                 call    MainOn                  ; turn on main transistor
0067   2859           00195                 goto    waitPress1              ; wait for next button press
                      00196 
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE  5
Case 3, Group 7

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0068                  00197 MainOff1
0068   2115           00198                 call    MainOff                 ; turn off main transistor
0069   2859           00199                 goto    waitPress1              ; wait for next button press
                      00200 
                      00201 ;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                      00202 
                      00203 
006A                  00204 waitPress2                                              ; wait press for mode2
006A   1807           00205                 btfsc   PORTC,0                 ; see if green button pressed
006B   2852           00206                 goto    GreenPress              ; green button is pressed - goto routine
006C   1887           00207                 btfsc   PORTC,1                 ; see if red button pressed
006D   286F           00208                 goto    RedPress2               ; red button is pressed - goto routine
006E   286A           00209                 goto    waitPress2              ; keep checking
                      00210 
006F                  00211 RedPress2
006F   1C87           00212                 btfss   PORTC,1                 ; see if red button still pressed
0070   286A           00213                 goto    waitPress2              ; noise - button not pressed - keep checking
                      00214 
0071                  00215 RedRelease2
0071   1887           00216                 btfsc   PORTC,1                 ; see if red button released
0072   2871           00217                 goto    RedRelease2             ; no - keep waiting
0073   20DB           00218                 call    SwitchDelay     ; let switch debounce
0074   191F           00219                 btfsc   ADCON0,GO               ; check A/D is finished - dont think this goes here
0075   2871           00220                 goto    RedRelease2             ; loop right here until A/D finished
0076   081E           00221                 movf    ADRESH,W                ; get A/D value
0077   00A3           00222                 movwf   Temp1                   ; move A/D value to temp register
                      00223                 ; fault indication
Message[305]: Using default destination of 1 (file).
0078   0AA3           00224                 incf    Temp1                   ; increment the value to test for control pot 0
0079   211F           00225                 call    ZeroError               ; control pot is 0, display error
007A   2113           00226                 call    MainOn                  ; turn on main transistor
007B   1003           00227                 bcf             STATUS,C                ; clear status bit
007C   0C23           00228                 rrf             Temp1,W                 ; divided by 2
007D   00A3           00229                 movwf   Temp1                   ; move the value back to Temp1
007E   1003           00230                 bcf             STATUS,C                ; clear status bit
007F   0C23           00231                 rrf             Temp1,W                 ; divided by 2
0080   00A3           00232                 movwf   Temp1                   ; move the value back to Temp1
0081   20E0           00233                 call    delay2                  ; go to delay (count down)
0082   2115           00234                 call    MainOff                 ; turn off main transistor
0083   286A           00235                 goto    waitPress2              ; wait for next button press
                      00236 
0084                  00237 RedPress2Check
0084   1C87           00238                 btfss   PORTC,1                 ; see if red button still pressed
0085   0008           00239                 return                                  ; button not pressed - return to delay timer
0086   2871           00240                 goto    RedRelease2     ; restart the timer reading
                      00241 
                      00242 ;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                      00243 
                      00244 
0087                  00245 waitPress3
0087   1807           00246                 btfsc   PORTC,0                 ; see if green button pressed
0088   2852           00247                 goto    GreenPress              ; green button is pressed - goto routine
0089   1887           00248                 btfsc   PORTC,1                 ; see if red button pressed
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE  6
Case 3, Group 7

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

008A   288C           00249                 goto    RedPress3               ; red button is pressed - goto routine
008B   2887           00250                 goto    waitPress3              ; keep checking
                      00251 
008C                  00252 RedPress3
008C   1C87           00253                 btfss   PORTC,1                 ; see if red button still pressed
008D   2887           00254                 goto    waitPress3              ; noise - button not pressed - keep checking
                      00255 
008E                  00256 RedRelease3
008E   1887           00257                 btfsc   PORTC,1                 ; see if red button released
008F   288E           00258                 goto    RedRelease3             ; no - keep waiting
0090   20DB           00259                 call    SwitchDelay     ; let switch debounce
0091   211B           00260                 call    LEDOn                   ; turn LED on
                      00261 
0092                  00262 ReadAD
0092   151F           00263                 bsf             ADCON0,GO               ; start A/D conversion
0093   191F           00264                 btfsc   ADCON0,GO               ; check A/D is finished
0094   2892           00265                 goto    ReadAD
0095   191F           00266                 btfsc   ADCON0,GO               ; check A/D is finished
0096   2892           00267                 goto    ReadAD
0097   081E           00268                 movf    ADRESH,W                ; get A/D value
0098   00A3           00269                 movwf   Temp1                   ; move A/D value to temp register
                      00270                 ; fault indication
Message[305]: Using default destination of 1 (file).
0099   0AA3           00271                 incf    Temp1                   ; increment the value to test for control pot 0
009A   211F           00272                 call    ZeroError               ; control pot is 0, display error
009B   289D           00273                 goto    checkGreater    ; 
009C   2887           00274                 goto    waitPress3              ; wait for next button press
                      00275 
009D                  00276 checkGreater
009D   3071           00277                 movlw   71h                     ; move value 71h to W register
009E   02A3           00278                 subwf   Temp1,1                 ; subtract w register from f register (f-W) and move res
                            ult to Temp1
009F   1BA3           00279                 btfsc   Temp1,7                 ; check the negative bit MSB, if 0 (positive) skip next 
                            instruction
00A0   28A3           00280                 goto    MainOff3                ; turn off transistor
00A1   2113           00281                 call    MainOn                  ; turn on transistor
00A2   28A5           00282                 goto    RedPress32              ; go to the other RedPress for mode 3
                      00283 
00A3                  00284 MainOff3
00A3   2115           00285                 call    MainOff
00A4   28A5           00286                 goto    RedPress32
                      00287 
                      00288 
00A5                  00289 RedPress32
00A5   1C87           00290                 btfss   PORTC,1                 ; see if red button pressed
00A6   2892           00291                 goto    ReadAD                  ; noise - button not pressed - go back to reading A/D va
                            lue
                      00292 
00A7                  00293 RedRelease32
00A7   1887           00294                 btfsc   PORTC,1                 ; see if red button released
00A8   28A7           00295                 goto    RedRelease32    ; no - keep waiting
00A9   20DB           00296                 call    SwitchDelay     ; let switch debounce
00AA   2115           00297                 call    MainOff                 ; turn off transistor
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE  7
Case 3, Group 7

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00AB   211D           00298                 call    LEDOff                  ; turn off LED
00AC   2887           00299                 goto    waitPress3              ; return back to waiting for green or red press
                      00300 
                      00301 ;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                      00302 
                      00303 
00AD                  00304 waitPress4
00AD   1807           00305                 btfsc   PORTC,0                 ; see if green button pressed
00AE   2852           00306                 goto    GreenPress              ; green button is pressed - goto routine
00AF   1887           00307                 btfsc   PORTC,1                 ; see if red button pressed
00B0   28B2           00308                 goto    RedPress4               ; red button is pressed - goto routine
00B1   28AD           00309                 goto    waitPress4              ; keep checking
                      00310 
00B2                  00311 RedPress4
00B2   1C87           00312                 btfss   PORTC,1                 ; see if red button still pressed
00B3   28AD           00313                 goto    waitPress4              ; noise - button not pressed - keep checking
                      00314 
00B4                  00315 RedRelease4
00B4   1887           00316                 btfsc   PORTC,1                 ; see if red button released
00B5   28B4           00317                 goto    RedRelease4             ; no - keep waiting
Message[305]: Using default destination of 1 (file).
00B6   0AA0           00318                 incf    Count                   ; increment the Reset Counter
00B7   20DB           00319                 call    SwitchDelay     ; let switch debounce
                      00320 
00B8                  00321 ReadAD4
00B8   151F           00322                 bsf             ADCON0,GO               ; start A/D conversion
00B9   191F           00323                 btfsc   ADCON0,GO               ; check A/D is finished
00BA   28B8           00324                 goto    ReadAD4                 ; loop right here until A/D finished
00BB   191F           00325                 btfsc   ADCON0,GO               ; check A/D is finished
00BC   28B8           00326                 goto    ReadAD4                 ; loop right here until A/D finished
00BD   081E           00327                 movf    ADRESH,W                ; get A/D value
00BE   00A3           00328                 movwf   Temp1                   ; move A/D value to temp register
                      00329                 ; fault indication
Message[305]: Using default destination of 1 (file).
00BF   0AA3           00330                 incf    Temp1                   ; increment the value to test for control pot 0
00C0   211F           00331                 call    ZeroError               ; test if control pot is 0, display error if so, return 
                            if not
00C1   28C2           00332                 goto    ReStart4                ; go to part of code where Restart4 is located
                      00333 
00C2                  00334 ReStart4
00C2   2113           00335                 call    MainOn                  ; turn on main transistor
00C3   20D2           00336                 call    checkSensor             ; check the state of sensor 
00C4   2117           00337                 call    ReducedOn               ; turn on reduced transistor
00C5   20F8           00338                 call    SetupDelay              ; wait a little
00C6   2115           00339                 call    MainOff                 ; turn off main transistor
00C7   1003           00340                 bcf             STATUS,C                ; clear the carry bit
00C8   0C23           00341                 rrf             Temp1,W                 ; divide A/D by 2
00C9   00A3           00342                 movwf   Temp1                   ; move value to Temp1
00CA   1003           00343                 bcf             STATUS,C                ; clear the carry bit
00CB   0C23           00344                 rrf             Temp1,W                 ; divide A/D by 2
00CC   00A3           00345                 movwf   Temp1                   ; move value to Temp1
00CD   20EB           00346                 call    delay42                 ; call time for A/D value
00CE   2119           00347                 call    ReducedOff              ; turn off reduced transistor
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE  8
Case 3, Group 7

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00CF   01A0           00348                 clrf    Count                   ; clear the restart counter
00D0   20F1           00349                 call    delay43                 ; check if transistor off
00D1   28AD           00350                 goto    waitPress4              ; wait for next button press
                      00351 
00D2                  00352 checkSensor
00D2   1E88           00353                 btfss   PORTD,5                 ; check if high
00D3   28E5           00354                 goto    delay4                  ; if low, go to delay
00D4   0008           00355                 return                                  ; if high, go back
                      00356 
00D5                  00357 CheckOff4
00D5   1A88           00358                 btfsc   PORTD,5                 ; check if sensor low 
00D6   0008           00359                 return                                  ; if high, go back to delay
00D7   28AD           00360                 goto    waitPress4              ; if low, finish go back to start of mode 4
                      00361 
00D8                  00362 CheckReStart
Message[305]: Using default destination of 1 (file).
00D8   0BA0           00363                 decfsz  Count               ; check if first restart or not
00D9   2921           00364                 goto    ProgramError    ; if not first restart, error
00DA   28C2           00365                 goto    ReStart4                ; if first restart goto routine 
                      00366                 
                      00367 ;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                      00368 
                      00369 
00DB                  00370 SwitchDelay
00DB   3014           00371                 movlw   D'20'                   ; move decimal value 20 into W register
00DC   00A3           00372                 movwf   Temp1                   ; load Temp1 with the value
                      00373 
00DD                  00374 delay
00DD   0BA3           00375                 decfsz  Temp1, F                ; 60 usec delay loop
00DE   28DD           00376                 goto    delay                   ; loop until count equals zero
00DF   0008           00377                 return                                  ; return to calling routine
                      00378 
00E0                  00379 delay2
00E0   2084           00380                 call    RedPress2Check  ; check for red buton press, reread timer and reset  if pressed
00E1   20FD           00381                 call    timeLoop                ; 1 sec delay
00E2   0BA3           00382                 decfsz  Temp1, F                ; delay loop
00E3   28E0           00383                 goto    delay2                  ; loop until Temp1 equals zero
00E4   0008           00384                 return                                  ; return to calling routine
                      00385 
00E5                  00386 delay4
00E5   300A           00387                 movlw   D'10'                   ; move decimal value 10 into W register
00E6   00A4           00388                 movwf   Temp2                   ; move the value to Temp2
00E7   2106           00389                 call    timeLoop4               ; 1 sec delay
00E8   0BA4           00390                 decfsz  Temp2,F                 ; decrement timer
00E9   28D2           00391                 goto    checkSensor     ; if not 0, recheck sensor
00EA   2921           00392                 goto    ProgramError    ; if timer done, go to error
                      00393 
                      00394 
00EB                  00395 delay42
00EB   1E88           00396                 btfss   PORTD,5                 ; check if sensor is high
00EC   20D8           00397                 call    CheckReStart    ; if not check for first restart or not
00ED   2106           00398                 call    timeLoop4
00EE   0BA3           00399                 decfsz  Temp1,F                 ; if sensor high, decrement A/D timer
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE  9
Case 3, Group 7

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00EF   28EB           00400                 goto    delay42                 ; if timer not zero, reloop this section
00F0   0008           00401                 return                                  ; if timer done return to calling function
                      00402 
00F1                  00403 delay43
00F1   300A           00404                 movlw   D'10'                   ; move decimal value 10 into W register
00F2   00A4           00405                 movwf   Temp2                   ; move the value to Temp2
00F3   20D5           00406                 call    CheckOff4               ; check if sensor is low
00F4   2106           00407                 call    timeLoop4
00F5   0BA4           00408                 decfsz  Temp2,F                 ; decrement the count
00F6   28F1           00409                 goto    delay43                 ; loop back if 10 second wait not finished
00F7   2921           00410                 goto    ProgramError    ; show error after 10 second wait
                      00411 
00F8                  00412 SetupDelay
00F8   3003           00413                 movlw   03h                             ; load Temp2 with hex3
00F9   00A4           00414                 movwf   Temp2
                      00415 
00FA                  00416 delayAD
00FA   0BA4           00417                 decfsz  Temp2,F                 ; delay loop
00FB   28FA           00418                 goto    delayAD
00FC   0008           00419                 return
                      00420 
                      00421 
00FD                  00422 timeLoop
00FD   302C           00423                 movlw   2Ch
00FE   00A6           00424                 movwf   Timer1
00FF   3035           00425                 movlw   35h
0100   00A5           00426                 movwf   Timer0
                      00427 
0101                  00428 timeDelay
0101   0BA5           00429                 decfsz  Timer0,F
0102   2901           00430                 goto    timeDelay
0103   0BA6           00431                 decfsz  Timer1,F
0104   2901           00432                 goto    timeDelay
0105   0008           00433                 return
                      00434 
0106                  00435 timeLoop4
0106   3006           00436                 movlw   06h
0107   00A7           00437                 movwf   Timer2
0108   3016           00438                 movlw   16h
0109   00A6           00439                 movwf   Timer1
010A   3015           00440                 movlw   15h
010B   00A5           00441                 movwf   Timer0
                      00442 
010C                  00443 timeDelay4
010C   0BA5           00444                 decfsz  Timer0,F
010D   2901           00445                 goto    timeDelay
010E   0BA6           00446                 decfsz  Timer1,F
010F   2901           00447                 goto    timeDelay
0110   0BA7           00448                 decfsz  Timer2,F
0111   2901           00449                 goto    timeDelay
0112   0008           00450                 return
                      00451 
                      00452 ;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE 10
Case 3, Group 7

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00453 
                      00454 
0113                  00455 MainOn
0113   1508           00456                 bsf             PORTD,2                 ; set main transistor bit high
0114   0008           00457                 return
                      00458 
0115                  00459 MainOff 
0115   1108           00460                 bcf             PORTD,2                 ; set main transistor bit low
0116   0008           00461                 return
                      00462 
0117                  00463 ReducedOn
0117   1408           00464                 bsf             PORTD,0                 ; set reduced transistor bit high
0118   0008           00465                 return
                      00466 
0119                  00467 ReducedOff
0119   1008           00468                 bcf             PORTD,0                 ; set reduced transistor bit low
011A   0008           00469                 return
                      00470 
011B                  00471 LEDOn
011B   1588           00472                 bsf             PORTD,3                 ; turn LED on
011C   0008           00473                 return
                      00474 
011D                  00475 LEDOff
011D   1188           00476                 bcf             PORTD,3                 ; turn LED off
011E   0008           00477                 return
                      00478 
                      00479 ;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                      00480                 
                      00481 
011F                  00482 ZeroError
Message[305]: Using default destination of 1 (file).
011F   0BA3           00483                 decfsz  Temp1                   ; decrement to see if 0
0120   0008           00484                 return
                      00485 
0121                  00486 ProgramError
0121   1586           00487                 bsf     PORTB,3                 ; set error bit
0122   2115           00488                 call    MainOff                 ; turn off main transistor
0123   2119           00489                 call    ReducedOff              ; turn off reduced transistor
                      00490                 
                      00491                 ; indicate error on LEDS
                      00492                 ; continue to error loop isrService until processor reset
                      00493                 
                      00494 ;
                      00495 ;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                      00496 ;
                      00497 
                      00498 
0124                  00499 isrService
                      00500 
0124   2924           00501                 goto    isrService              ; error - stay here
                      00502 ;
                      00503 ;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                      00504 ;
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE 11
Case 3, Group 7

LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00505                 END                                             ; Assembler directive - end of program
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE 12
Case 3, Group 7

SYMBOL TABLE
  LABEL                             VALUE 

ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ACQT0                             00000003
ACQT1                             00000004
ACQT2                             00000005
ADCON0                            0000001F
ADCON1                            0000009F
ADCON2                            0000009B
ADCS0                             00000006
ADCS1                             00000007
ADCS2                             00000006
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
BCLIE                             00000003
BCLIF                             00000003
BF                                00000000
BRGH                              00000002
C                                 00000000
C1INV                             00000004
C1OUT                             00000006
C2INV                             00000005
C2OUT                             00000007
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCP3CON                           00000097
CCP3IE                            00000001
CCP3IF                            00000001
CCP3M0                            00000000
CCP3M1                            00000001
CCP3M2                            00000002
CCP3M3                            00000003
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE 13
Case 3, Group 7

SYMBOL TABLE
  LABEL                             VALUE 

CCP3X                             00000005
CCP3Y                             00000004
CCPR1                             00000015
CCPR1H                            00000016
CCPR1L                            00000015
CCPR2                             0000001B
CCPR2H                            0000001C
CCPR2L                            0000001B
CCPR3                             00000095
CCPR3H                            00000096
CCPR3L                            00000095
CHS0                              00000003
CHS1                              00000004
CHS2                              00000005
CHS3                              00000001
CIS                               00000003
CKE                               00000006
CKP                               00000004
CM0                               00000000
CM1                               00000001
CM2                               00000002
CMCON                             0000009C
CMIE                              00000006
CMIF                              00000006
CREN                              00000004
CSRC                              00000007
CVR0                              00000000
CVR1                              00000001
CVR2                              00000002
CVR3                              00000003
CVRCON                            0000009D
CVREN                             00000007
CVROE                             00000006
CVRR                              00000005
CheckOff4                         000000D5
CheckReStart                      000000D8
Count                             00000020
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
D_A                               00000005
D_NOT_A                           00000005
F                                 00000001
FERR                              00000002
FSR                               00000004
GCEN                              00000007
GIE                               00000007
GO                                00000002
GO_DONE                           00000002
GO_NOT_DONE                       00000002
GreenPress                        00000052
GreenRelease                      00000055
I2C_DATA                          00000005
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE 14
Case 3, Group 7

SYMBOL TABLE
  LABEL                             VALUE 

I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
INDF                              00000000
INT0IE                            00000004
INT0IF                            00000001
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IOFS                              00000002
IRCF0                             00000004
IRCF1                             00000005
IRCF2                             00000006
IRP                               00000007
IRVST                             00000005
LEDOff                            0000011D
LEDOn                             0000011B
LVDCON                            00000109
LVDEN                             00000004
LVDIE                             00000005
LVDIF                             00000005
LVDL0                             00000000
LVDL1                             00000001
LVDL2                             00000002
LVDL3                             00000003
MainOff                           00000115
MainOff1                          00000068
MainOff3                          000000A3
MainOn                            00000113
MainOn1                           00000066
Mode1                             00000040
Mode1234                          0000002E
Mode2                             00000043
Mode234                           0000003A
Mode3                             00000046
Mode34                            0000003D
Mode4                             0000004A
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000002
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE 15
Case 3, Group 7

SYMBOL TABLE
  LABEL                             VALUE 

NOT_WRITE                         00000002
OBF                               00000006
OERR                              00000001
OPTION_REG                        00000081
OSCCON                            0000008F
OSCTUNE                           00000090
OSFIE                             00000007
OSFIF                             00000007
OSTS                              00000003
Octal                             00000022
P                                 00000004
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PEIE                              00000006
PEN                               00000002
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PMADR                             0000010D
PMADRH                            0000010F
PMCON1                            0000018C
PMDATA                            0000010C
PMDATH                            0000010E
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PORTD                             00000008
PORTE                             00000009
PR2                               00000092
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSPIE                             00000007
PSPIF                             00000007
PSPMODE                           00000004
ProgramError                      00000121
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RA6                               00000006
RA7                               00000007
RB0                               00000000
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE 16
Case 3, Group 7

SYMBOL TABLE
  LABEL                             VALUE 

RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
RD0                               00000000
RD1                               00000001
RD2                               00000002
RD3                               00000003
RD4                               00000004
RD5                               00000005
RD6                               00000006
RD7                               00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
RE3                               00000003
READ_WRITE                        00000002
RP0                               00000005
RP1                               00000006
RSEN                              00000001
RX9                               00000006
RX9D                              00000000
R_NOT_W                           00000002
R_W                               00000002
ReStart4                          000000C2
ReadAD                            00000092
ReadAD4                           000000B8
RedPress1                         0000005E
RedPress2                         0000006F
RedPress2Check                    00000084
RedPress3                         0000008C
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE 17
Case 3, Group 7

SYMBOL TABLE
  LABEL                             VALUE 

RedPress32                        000000A5
RedPress4                         000000B2
RedRelease1                       00000060
RedRelease2                       00000071
RedRelease3                       0000008E
RedRelease32                      000000A7
RedRelease4                       000000B4
ReducedOff                        00000119
ReducedOn                         00000117
S                                 00000003
SBOREN                            00000002
SCS0                              00000000
SCS1                              00000001
SEN                               00000000
SMP                               00000007
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000094
STATUS                            00000003
SWDTE                             00000000
SWDTEN                            00000000
SYNC                              00000004
SetupDelay                        000000F8
State                             00000021
SwitchDelay                       000000DB
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1INSYNC                          00000002
T1OSCEN                           00000003
T1RUN                             00000006
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TMR0                              00000001
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE 18
Case 3, Group 7

SYMBOL TABLE
  LABEL                             VALUE 

TMR0IE                            00000005
TMR0IF                            00000002
TMR1                              0000000E
TMR1CS                            00000001
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISA6                            00000006
TRISA7                            00000007
TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000087
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRISD                             00000088
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
TRISD6                            00000006
TRISD7                            00000007
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE 19
Case 3, Group 7

SYMBOL TABLE
  LABEL                             VALUE 

TRISE                             00000089
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRISE3                            00000003
TRMT                              00000001
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TUN5                              00000005
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
Temp1                             00000023
Temp2                             00000024
Timer0                            00000025
Timer1                            00000026
Timer2                            00000027
UA                                00000001
VCFG0                             00000004
VCFG1                             00000005
W                                 00000000
WCOL                              00000007
WDTCON                            00000105
WDTPS0                            00000001
WDTPS1                            00000002
WDTPS2                            00000003
WDTPS3                            00000004
Z                                 00000002
ZeroError                         0000011F
_BOREN_0                          00003FBF
_BOREN_1                          00003FFF
_BOREN_OFF                        00003FBF
_BOREN_ON                         00003FFF
_BORSEN_0                         00003FBF
_BORSEN_1                         00003FFF
_BORSEN_OFF                       00003FBF
_BORSEN_ON                        00003FFF
_BORV_20                          00003FFF
_BORV_27                          00003F7F
_BORV_42                          00003EFF
_BORV_45                          00003E7F
_CCP2MX_RB3                       00002FFF
_CCP2MX_RC1                       00003FFF
_CCP2_RB3                         00002FFF
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE 20
Case 3, Group 7

SYMBOL TABLE
  LABEL                             VALUE 

_CCP2_RC1                         00003FFF
_CONFIG1                          00002007
_CONFIG2                          00002008
_CP_ALL                           00001FFF
_CP_OFF                           00003FFF
_CP_ON                            00001FFF
_DEBUG_OFF                        00003FFF
_DEBUG_ON                         000037FF
_DEVID1                           00002006
_EXTCLK                           00003FEF
_EXTRC_CLKOUT                     00003FFF
_EXTRC_IO                         00003FFE
_FCMEN_OFF                        00003FFE
_FCMEN_ON                         00003FFF
_FOSC_EC                          00003FEF
_FOSC_EXTRCCLK                    00003FFF
_FOSC_EXTRCIO                     00003FFE
_FOSC_HS                          00003FEE
_FOSC_INTOSCCLK                   00003FFD
_FOSC_INTOSCIO                    00003FFC
_FOSC_LP                          00003FEC
_FOSC_XT                          00003FED
_HS_OSC                           00003FEE
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_IESO_OFF                         00003FFD
_IESO_ON                          00003FFF
_INTRC_CLKOUT                     00003FFD
_INTRC_IO                         00003FFC
_LP_OSC                           00003FEC
_MCLRE_OFF                        00003FDF
_MCLRE_ON                         00003FFF
_MCLR_OFF                         00003FDF
_MCLR_ON                          00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_VBOR_2_0                         00003FFF
_VBOR_2_7                         00003F7F
_VBOR_4_2                         00003EFF
_VBOR_4_5                         00003E7F
_WDTE_OFF                         00003FFB
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_XT_OSC                           00003FED
__16F747                          00000001
__DEBUG                           1
checkGreater                      0000009D
checkSensor                       000000D2
delay                             000000DD
delay2                            000000E0
MPASM  5.51                         CASE3.ASM   11-15-2018  22:03:14         PAGE 21
Case 3, Group 7

SYMBOL TABLE
  LABEL                             VALUE 

delay4                            000000E5
delay42                           000000EB
delay43                           000000F1
delayAD                           000000FA
initAD                            00000027
initPort                          00000015
isrService                        00000124
timeDelay                         00000101
timeDelay4                        0000010C
timeLoop                          000000FD
timeLoop4                         00000106
waitPress                         0000004F
waitPress1                        00000059
waitPress2                        0000006A
waitPress3                        00000087
waitPress4                        000000AD


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : X---X----------- -----XXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXX----------- ----------------
2000 : -------XX------- ---------------- ---------------- ----------------

All other memory blocks unused.

Program Memory Words Used:   274
Program Memory Words Free:  3822


Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :    11 reported,     0 suppressed

